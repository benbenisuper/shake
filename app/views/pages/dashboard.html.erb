<div class="container">
  <h1 class="mt-5">Hello <%= current_user.first_name %></h1>

  <p>Below, you can see your current listing and bookings</p>

  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="bookings-tab" data-toggle="tab" href="#bookings" role="tab" aria-controls="bookings" aria-selected="true">Your Bookings</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="listings-tab" data-toggle="tab" href="#listings" role="tab" aria-controls="listings" aria-selected="false">Your Listings</a>
    </li>
  </ul>

  <div class="tab-content" id="myTabContent">

    <div class="tab-pane fade show active" id="bookings" role="tabpanel" aria-labelledby="bookings-tab">

      <% if current_user.bookings == [] %>
      <h4 class="mt-4">Looks empty here. Book something!</h4>
      <% end %>

      <% current_user.bookings.each do |booking|%>

      <div class="card-dashboard mt-2">
        <!-- IF BOOKING DOESNT HAVE A VENUE ASSIGNED THEN IT WILL USE A PLACEHOLDER IMAGE -->
        <%= cl_image_tag booking.venue.nil? ? 'placeholder' : booking.venue.venue_image, class:"card-img-top" %>
        <div class="card-dashboard-infos">
          <h2 class="card-title">
            <%= link_to booking_path(booking) do %>
            <!-- IF BOOKING DOESNT HAVE A VENUE ASSIGNED THEN IT WILL USE A DELETED VENUE MESSAGE AS NAME -->
            <%= booking.venue.nil? ? "DELETED VENUE" : booking.venue.name %>
            <% end %>
          </h2>
          <p><%= booking.start.to_formatted_s(:short) %> - <%= booking.end.to_formatted_s(:short) %></p>
        </div>
        <div class="crud ml-auto mt-auto mr-2 mb-2">
          <%= link_to edit_booking_path(booking), class: 'btn btn-primary mr-2' do %>
          Edit
          <% end %>
          <%= link_to booking_path(booking), method: :delete, data: { confirm: "Are you sure?" }, class: 'btn btn-warning mr-1' do %>
          Delete
          <% end %>
        </div>
      </div>
      <% end %>

    </div>


    <div class="tab-pane fade" id="listings" role="tabpanel" aria-labelledby="listings-tab">

      <% if current_user.venues == [] %>
      <h4 class="mt-4">Looks empty here. Book something!</h4>
      <% end %>

      <% current_user.venues.each do |venue|%>

      <div class="card-dashboard mt-2">
        <%= cl_image_tag venue.venue_image, class:"card-img-top" %>
        <div class="card-dashboard-infos">
          <h2 class="card-title"><%= link_to venue_path(venue) do %><%= venue.name %><% end %></h2>
          <p><%= venue.description %></p>
        </div>
        <div class="crud ml-auto mt-auto mr-2 mb-2">
          <%= link_to edit_venue_path(venue), class: 'btn btn-primary mr-2' do %>
            Edit
          <% end %>
          <%= link_to venue_path(venue), method: :delete, data: { confirm: "Are you sure?" }, class: 'btn btn-warning mr-1' do %>
            Delete
          <% end %>
        </div>
      </div>
      <% end %>

    </div>
  </div>
</div>

